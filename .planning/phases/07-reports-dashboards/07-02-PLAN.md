---
phase: 07-reports-dashboards
plan: 02
type: execute
wave: 1
depends_on: []
files_modified:
  - apps/web/package.json
  - apps/web/src/components/reports/charts/AttendanceBarChart.tsx
  - apps/web/src/components/reports/charts/TimesheetPieChart.tsx
  - apps/web/src/components/reports/charts/index.ts
  - apps/web/src/components/reports/widgets/MetricCard.tsx
  - apps/web/src/components/reports/widgets/NeedsAttentionSection.tsx
  - apps/web/src/components/reports/widgets/TeamStatusTable.tsx
  - apps/web/src/components/reports/widgets/index.ts
  - apps/web/src/components/reports/pdf/pdfConfig.ts
  - apps/web/src/components/reports/pdf/PdfExportButton.tsx
  - apps/web/src/components/reports/pdf/generators/attendanceReport.ts
  - apps/web/src/components/reports/pdf/generators/timesheetReport.ts
  - apps/web/src/components/reports/pdf/index.ts
  - apps/web/src/components/reports/index.ts
autonomous: true

must_haves:
  truths:
    - "Chart components render data visualizations"
    - "PDF export generates downloadable A4 portrait reports"
    - "Metric cards display dashboard statistics"
  artifacts:
    - path: "apps/web/src/components/reports/charts/AttendanceBarChart.tsx"
      provides: "Stacked bar chart for attendance data"
      min_lines: 30
    - path: "apps/web/src/components/reports/pdf/PdfExportButton.tsx"
      provides: "Button component triggering PDF download"
      min_lines: 20
    - path: "apps/web/src/components/reports/widgets/NeedsAttentionSection.tsx"
      provides: "Anomaly highlighting section"
      min_lines: 25
  key_links:
    - from: "apps/web/src/components/reports/charts/AttendanceBarChart.tsx"
      to: "recharts"
      via: "import"
      pattern: "from 'recharts'"
    - from: "apps/web/src/components/reports/pdf/PdfExportButton.tsx"
      to: "jspdf"
      via: "import"
      pattern: "from 'jspdf'"
---

<objective>
Install charting and PDF libraries, create reusable chart components, metric widgets, and PDF export utilities.

Purpose: Foundation UI components for dashboard visualizations and report export functionality.
Output: Recharts chart components, metric card widgets, NeedsAttention section, PDF generator utilities.
</objective>

<execution_context>
@/Users/adityaw/.claude/get-shit-done/workflows/execute-plan.md
@/Users/adityaw/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/phases/07-reports-dashboards/07-CONTEXT.md
@.planning/phases/07-reports-dashboards/07-RESEARCH.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: Install Dependencies</name>
  <files>apps/web/package.json</files>
  <action>
Install Recharts for charting and jsPDF with jspdf-autotable for PDF generation.

Run:
```bash
npm install recharts jspdf jspdf-autotable --workspace=@satcom/web
```

Verify package.json has:
- recharts: ^3.7.0 (or compatible 3.x)
- jspdf: ^4.0.0 (or compatible 4.x)
- jspdf-autotable: ^5.0.7 (or compatible 5.x)

Note: These are client-side libraries, no server-side rendering issues expected with Next.js App Router when using 'use client' directive.
  </action>
  <verify>`npm list recharts jspdf jspdf-autotable --workspace=@satcom/web` shows all three packages installed</verify>
  <done>Recharts 3.x, jsPDF 4.x, and jspdf-autotable 5.x installed in web workspace</done>
</task>

<task type="auto">
  <name>Task 2: Create Chart Components</name>
  <files>
    apps/web/src/components/reports/charts/AttendanceBarChart.tsx
    apps/web/src/components/reports/charts/TimesheetPieChart.tsx
    apps/web/src/components/reports/charts/index.ts
  </files>
  <action>
Create reusable chart components following Recharts patterns from research.

1. Create `apps/web/src/components/reports/charts/AttendanceBarChart.tsx`:

```typescript
'use client';

/**
 * AttendanceBarChart
 *
 * Stacked bar chart showing daily attendance breakdown:
 * - On Time (green)
 * - Late (orange)
 * - Absent (red)
 * - On Leave (purple)
 */

import {
  ResponsiveContainer,
  BarChart,
  Bar,
  XAxis,
  YAxis,
  CartesianGrid,
  Tooltip,
  Legend,
} from 'recharts';

interface AttendanceData {
  date: string;
  checkedIn: number;
  late: number;
  absent: number;
  onLeave: number;
}

interface AttendanceBarChartProps {
  data: AttendanceData[];
  height?: number;
}

const CustomTooltip = ({ active, payload, label }: any) => {
  if (active && payload && payload.length) {
    return (
      <div className="bg-white p-3 rounded-lg shadow-lg border border-silver-200">
        <p className="font-semibold text-navy-900 mb-1">{label}</p>
        {payload.map((entry: any, index: number) => (
          <p key={index} className="text-sm" style={{ color: entry.color }}>
            {entry.name}: {entry.value}
          </p>
        ))}
      </div>
    );
  }
  return null;
};

export function AttendanceBarChart({ data, height = 300 }: AttendanceBarChartProps) {
  // Format date for display (e.g., "Mon", "Tue")
  const formattedData = data.map(d => ({
    ...d,
    displayDate: new Date(d.date).toLocaleDateString('en-US', { weekday: 'short' }),
  }));

  return (
    <ResponsiveContainer width="100%" height={height}>
      <BarChart data={formattedData} margin={{ top: 20, right: 30, left: 0, bottom: 5 }}>
        <CartesianGrid strokeDasharray="3 3" stroke="#e2e8f0" />
        <XAxis dataKey="displayDate" stroke="#64748b" fontSize={12} />
        <YAxis stroke="#64748b" fontSize={12} />
        <Tooltip content={<CustomTooltip />} />
        <Legend />
        <Bar dataKey="checkedIn" stackId="a" fill="#22c55e" name="On Time" />
        <Bar dataKey="late" stackId="a" fill="#f59e0b" name="Late" />
        <Bar dataKey="absent" stackId="a" fill="#ef4444" name="Absent" />
        <Bar dataKey="onLeave" stackId="a" fill="#a855f7" name="On Leave" />
      </BarChart>
    </ResponsiveContainer>
  );
}
```

2. Create `apps/web/src/components/reports/charts/TimesheetPieChart.tsx`:

```typescript
'use client';

/**
 * TimesheetPieChart
 *
 * Pie chart showing hours by project.
 */

import {
  ResponsiveContainer,
  PieChart,
  Pie,
  Cell,
  Tooltip,
  Legend,
} from 'recharts';

interface TimesheetData {
  projectId: string;
  projectName: string;
  totalMinutes: number;
  entryCount: number;
}

interface TimesheetPieChartProps {
  data: TimesheetData[];
  height?: number;
}

// Color palette for projects
const COLORS = ['#3b82f6', '#22c55e', '#f59e0b', '#ef4444', '#a855f7', '#06b6d4', '#ec4899', '#84cc16'];

const CustomTooltip = ({ active, payload }: any) => {
  if (active && payload && payload.length) {
    const data = payload[0].payload;
    const hours = Math.floor(data.totalMinutes / 60);
    const mins = data.totalMinutes % 60;
    return (
      <div className="bg-white p-3 rounded-lg shadow-lg border border-silver-200">
        <p className="font-semibold text-navy-900">{data.projectName}</p>
        <p className="text-sm text-silver-600">{hours}h {mins}m</p>
        <p className="text-xs text-silver-500">{data.entryCount} entries</p>
      </div>
    );
  }
  return null;
};

export function TimesheetPieChart({ data, height = 300 }: TimesheetPieChartProps) {
  if (data.length === 0) {
    return (
      <div className="flex items-center justify-center h-[300px] text-silver-500">
        No timesheet data for this period
      </div>
    );
  }

  return (
    <ResponsiveContainer width="100%" height={height}>
      <PieChart>
        <Pie
          data={data}
          dataKey="totalMinutes"
          nameKey="projectName"
          cx="50%"
          cy="50%"
          outerRadius={80}
          label={({ name, percent }) => `${name} (${(percent * 100).toFixed(0)}%)`}
          labelLine={false}
        >
          {data.map((entry, index) => (
            <Cell key={entry.projectId} fill={COLORS[index % COLORS.length]} />
          ))}
        </Pie>
        <Tooltip content={<CustomTooltip />} />
        <Legend />
      </PieChart>
    </ResponsiveContainer>
  );
}
```

3. Create `apps/web/src/components/reports/charts/index.ts`:

```typescript
export { AttendanceBarChart } from './AttendanceBarChart';
export { TimesheetPieChart } from './TimesheetPieChart';
```

Chart components use:
- ResponsiveContainer wrapper (required for SSR safety)
- 'use client' directive (required for Recharts)
- Custom tooltips for better UX
- Consistent color palette matching Tailwind theme
  </action>
  <verify>Files exist and contain 'use client' directive at top</verify>
  <done>AttendanceBarChart and TimesheetPieChart components created with ResponsiveContainer wrappers</done>
</task>

<task type="auto">
  <name>Task 3: Create Widget Components and PDF Utilities</name>
  <files>
    apps/web/src/components/reports/widgets/MetricCard.tsx
    apps/web/src/components/reports/widgets/NeedsAttentionSection.tsx
    apps/web/src/components/reports/widgets/TeamStatusTable.tsx
    apps/web/src/components/reports/widgets/index.ts
    apps/web/src/components/reports/pdf/pdfConfig.ts
    apps/web/src/components/reports/pdf/PdfExportButton.tsx
    apps/web/src/components/reports/pdf/generators/attendanceReport.ts
    apps/web/src/components/reports/pdf/generators/timesheetReport.ts
    apps/web/src/components/reports/pdf/index.ts
    apps/web/src/components/reports/index.ts
  </files>
  <action>
Create metric widgets and PDF export utilities.

1. Create `apps/web/src/components/reports/widgets/MetricCard.tsx`:

```typescript
'use client';

import { LucideIcon } from 'lucide-react';
import { motion } from 'framer-motion';

interface MetricCardProps {
  title: string;
  value: string | number;
  subtitle?: string;
  icon: LucideIcon;
  color: 'blue' | 'green' | 'orange' | 'red' | 'purple';
  trend?: { value: number; isPositive: boolean };
}

const colorClasses = {
  blue: 'from-blue-500 to-blue-600',
  green: 'from-green-500 to-green-600',
  orange: 'from-orange-500 to-orange-600',
  red: 'from-red-500 to-red-600',
  purple: 'from-purple-500 to-purple-600',
};

export function MetricCard({ title, value, subtitle, icon: Icon, color, trend }: MetricCardProps) {
  return (
    <motion.div
      initial={{ opacity: 0, y: 10 }}
      animate={{ opacity: 1, y: 0 }}
      className={`bg-gradient-to-br ${colorClasses[color]} rounded-xl p-5 text-white`}
    >
      <div className="flex items-center justify-between mb-3">
        <Icon size={24} />
        <span className="text-2xl font-bold">{value}</span>
      </div>
      <p className="text-white/80 text-sm">{title}</p>
      {subtitle && <p className="text-xs text-white/60 mt-1">{subtitle}</p>}
      {trend && (
        <p className={`text-xs mt-1 ${trend.isPositive ? 'text-green-200' : 'text-red-200'}`}>
          {trend.isPositive ? '+' : ''}{trend.value}% vs last week
        </p>
      )}
    </motion.div>
  );
}
```

2. Create `apps/web/src/components/reports/widgets/NeedsAttentionSection.tsx`:

```typescript
'use client';

/**
 * NeedsAttentionSection
 *
 * Per user decision: Red badges, dedicated section at top, inline icons
 * Shows anomalies, late arrivals, and pending items requiring action.
 */

import { AlertTriangle, Clock, Shield, Calendar, ChevronRight } from 'lucide-react';
import { useRouter } from 'next/navigation';
import { motion } from 'framer-motion';

interface AttentionItem {
  icon: typeof AlertTriangle;
  count: number;
  label: string;
  href?: string;
  color: string;
}

interface NeedsAttentionSectionProps {
  anomalyCount: number;
  lateCount: number;
  absentCount?: number;
}

export function NeedsAttentionSection({ anomalyCount, lateCount, absentCount = 0 }: NeedsAttentionSectionProps) {
  const router = useRouter();

  // Hide if nothing needs attention
  if (anomalyCount === 0 && lateCount === 0 && absentCount === 0) {
    return null;
  }

  const items: AttentionItem[] = [];

  if (anomalyCount > 0) {
    items.push({
      icon: Shield,
      count: anomalyCount,
      label: 'Open Anomalies',
      href: '/admin/anomalies',
      color: 'text-error',
    });
  }

  if (lateCount > 0) {
    items.push({
      icon: Clock,
      count: lateCount,
      label: 'Late Today',
      color: 'text-warning',
    });
  }

  if (absentCount > 0) {
    items.push({
      icon: Calendar,
      count: absentCount,
      label: 'Absent Today',
      color: 'text-silver-600',
    });
  }

  return (
    <motion.div
      initial={{ opacity: 0, y: -10 }}
      animate={{ opacity: 1, y: 0 }}
      className="bg-error-light border border-error/20 rounded-xl p-4 mb-6"
    >
      <div className="flex items-center gap-2 mb-3">
        <AlertTriangle className="text-error" size={20} />
        <h2 className="font-semibold text-navy-900">Needs Attention</h2>
      </div>
      <div className="grid grid-cols-1 md:grid-cols-3 gap-4">
        {items.map((item, index) => (
          <button
            key={index}
            onClick={() => item.href && router.push(item.href)}
            className={`flex items-center justify-between p-3 bg-white rounded-lg border border-silver-200 ${item.href ? 'hover:border-error/30 cursor-pointer' : 'cursor-default'} transition-colors`}
          >
            <div className="flex items-center gap-3">
              <div className={`p-2 rounded-lg bg-silver-50`}>
                <item.icon size={18} className={item.color} />
              </div>
              <div className="text-left">
                <p className="text-2xl font-bold text-navy-900">{item.count}</p>
                <p className="text-sm text-silver-600">{item.label}</p>
              </div>
            </div>
            {item.href && <ChevronRight size={18} className="text-silver-400" />}
          </button>
        ))}
      </div>
    </motion.div>
  );
}
```

3. Create `apps/web/src/components/reports/widgets/TeamStatusTable.tsx`:

```typescript
'use client';

/**
 * TeamStatusTable
 *
 * Shows team members with their attendance status today.
 * Per user decision: Inline warning icons next to affected rows.
 */

import { AlertTriangle, CheckCircle, Clock, XCircle } from 'lucide-react';

interface TeamMember {
  userId: string;
  userName: string;
  checkInTime?: string;
  checkOutTime?: string;
  workMode?: string;
  isLate: boolean;
  isAbsent: boolean;
  currentProject?: string;
}

interface TeamStatusTableProps {
  members: TeamMember[];
}

export function TeamStatusTable({ members }: TeamStatusTableProps) {
  if (members.length === 0) {
    return (
      <div className="text-center py-8 text-silver-500">
        No team members to display
      </div>
    );
  }

  const formatTime = (isoString?: string) => {
    if (!isoString) return '-';
    return new Date(isoString).toLocaleTimeString('en-US', {
      hour: '2-digit',
      minute: '2-digit',
    });
  };

  return (
    <div className="overflow-x-auto">
      <table className="w-full">
        <thead>
          <tr className="text-left text-xs text-silver-500 uppercase border-b border-silver-100">
            <th className="pb-3 font-medium">Employee</th>
            <th className="pb-3 font-medium">Status</th>
            <th className="pb-3 font-medium">Check In</th>
            <th className="pb-3 font-medium">Check Out</th>
            <th className="pb-3 font-medium">Work Mode</th>
          </tr>
        </thead>
        <tbody className="divide-y divide-silver-50">
          {members.map((member) => (
            <tr key={member.userId} className="hover:bg-silver-50">
              <td className="py-3">
                <div className="flex items-center gap-2">
                  <div className="w-8 h-8 bg-blue-100 rounded-full flex items-center justify-center">
                    <span className="text-blue-600 text-xs font-medium">
                      {member.userName.split(' ').map(n => n[0]).join('')}
                    </span>
                  </div>
                  <span className="text-sm font-medium text-navy-900">{member.userName}</span>
                  {/* Inline warning icon for issues */}
                  {member.isLate && <AlertTriangle size={14} className="text-warning" title="Late" />}
                  {member.isAbsent && <XCircle size={14} className="text-error" title="Absent" />}
                </div>
              </td>
              <td className="py-3">
                {member.isAbsent ? (
                  <span className="px-2 py-0.5 text-xs rounded-full bg-error-light text-error">
                    Absent
                  </span>
                ) : member.isLate ? (
                  <span className="px-2 py-0.5 text-xs rounded-full bg-warning-light text-warning">
                    Late
                  </span>
                ) : member.checkInTime ? (
                  <span className="px-2 py-0.5 text-xs rounded-full bg-success-light text-success">
                    On Time
                  </span>
                ) : (
                  <span className="px-2 py-0.5 text-xs rounded-full bg-silver-100 text-silver-600">
                    -
                  </span>
                )}
              </td>
              <td className="py-3 text-sm text-navy-900">{formatTime(member.checkInTime)}</td>
              <td className="py-3 text-sm text-navy-900">{formatTime(member.checkOutTime)}</td>
              <td className="py-3 text-sm text-silver-600">{member.workMode || '-'}</td>
            </tr>
          ))}
        </tbody>
      </table>
    </div>
  );
}
```

4. Create `apps/web/src/components/reports/widgets/index.ts`:

```typescript
export { MetricCard } from './MetricCard';
export { NeedsAttentionSection } from './NeedsAttentionSection';
export { TeamStatusTable } from './TeamStatusTable';
```

5. Create `apps/web/src/components/reports/pdf/pdfConfig.ts`:

```typescript
/**
 * PDF Configuration
 *
 * A4 Portrait orientation, tables only (per user decision)
 */

// A4 dimensions: 210mm x 297mm
export const PDF_CONFIG = {
  orientation: 'portrait' as const,
  unit: 'mm' as const,
  format: 'a4' as const,
  margins: { top: 20, right: 14, bottom: 20, left: 14 },
  headerHeight: 35,
  footerHeight: 15,
  colors: {
    primary: [30, 64, 175] as [number, number, number],    // Blue-700
    text: [30, 41, 59] as [number, number, number],        // Navy-900
    textMuted: [100, 116, 139] as [number, number, number], // Silver-500
    alternateRow: [248, 250, 252] as [number, number, number], // Silver-50
  },
};
```

6. Create `apps/web/src/components/reports/pdf/generators/attendanceReport.ts`:

```typescript
/**
 * Attendance Report PDF Generator
 *
 * Generates A4 portrait PDF with attendance data tables.
 */

import { jsPDF } from 'jspdf';
import autoTable from 'jspdf-autotable';
import { PDF_CONFIG } from '../pdfConfig';

interface AttendanceRow {
  userName: string;
  checkInTime: string;
  checkOutTime: string;
  workMode: string;
  status: string;
  totalHours: string;
}

interface AttendanceReportData {
  title: string;
  dateRange: string;
  summary: {
    total: number;
    present: number;
    late: number;
    absent: number;
  };
  rows: AttendanceRow[];
}

export function generateAttendanceReport(data: AttendanceReportData): void {
  const doc = new jsPDF(PDF_CONFIG.orientation, PDF_CONFIG.unit, PDF_CONFIG.format);

  // Header
  doc.setFontSize(18);
  doc.setTextColor(...PDF_CONFIG.colors.text);
  doc.text(data.title, PDF_CONFIG.margins.left, 20);

  doc.setFontSize(10);
  doc.setTextColor(...PDF_CONFIG.colors.textMuted);
  doc.text(data.dateRange, PDF_CONFIG.margins.left, 28);
  doc.text(
    `Generated: ${new Date().toLocaleDateString('en-US', { year: 'numeric', month: 'long', day: 'numeric' })}`,
    PDF_CONFIG.margins.left,
    34
  );

  // Summary section
  doc.setFontSize(12);
  doc.setTextColor(...PDF_CONFIG.colors.text);
  doc.text('Summary', PDF_CONFIG.margins.left, 45);

  autoTable(doc, {
    startY: 50,
    head: [['Total', 'Present', 'Late', 'Absent']],
    body: [[data.summary.total, data.summary.present, data.summary.late, data.summary.absent]],
    styles: { fontSize: 10, cellPadding: 3 },
    headStyles: { fillColor: PDF_CONFIG.colors.primary, textColor: [255, 255, 255] },
    margin: { left: PDF_CONFIG.margins.left, right: PDF_CONFIG.margins.right },
  });

  // Details table
  const finalY = (doc as any).lastAutoTable.finalY + 10;
  doc.text('Details', PDF_CONFIG.margins.left, finalY);

  autoTable(doc, {
    startY: finalY + 5,
    head: [['Employee', 'Check In', 'Check Out', 'Mode', 'Status', 'Hours']],
    body: data.rows.map(row => [
      row.userName,
      row.checkInTime,
      row.checkOutTime,
      row.workMode,
      row.status,
      row.totalHours,
    ]),
    styles: { fontSize: 9, cellPadding: 3, textColor: PDF_CONFIG.colors.text },
    headStyles: { fillColor: PDF_CONFIG.colors.primary, textColor: [255, 255, 255], fontStyle: 'bold' },
    alternateRowStyles: { fillColor: PDF_CONFIG.colors.alternateRow },
    margin: { left: PDF_CONFIG.margins.left, right: PDF_CONFIG.margins.right },
    didDrawPage: (data) => {
      // Footer with page number
      const pageCount = doc.getNumberOfPages();
      doc.setFontSize(8);
      doc.setTextColor(...PDF_CONFIG.colors.textMuted);
      doc.text(
        `Page ${data.pageNumber} of ${pageCount}`,
        doc.internal.pageSize.getWidth() / 2,
        doc.internal.pageSize.getHeight() - 10,
        { align: 'center' }
      );
    },
  });

  // Save
  const filename = `attendance-report-${new Date().toISOString().split('T')[0]}.pdf`;
  doc.save(filename);
}
```

7. Create `apps/web/src/components/reports/pdf/generators/timesheetReport.ts`:

```typescript
/**
 * Timesheet Report PDF Generator
 *
 * Generates A4 portrait PDF with timesheet data tables.
 */

import { jsPDF } from 'jspdf';
import autoTable from 'jspdf-autotable';
import { PDF_CONFIG } from '../pdfConfig';

interface TimesheetRow {
  projectName: string;
  totalHours: string;
  entryCount: number;
  percentage: string;
}

interface TimesheetReportData {
  title: string;
  dateRange: string;
  totalHours: string;
  rows: TimesheetRow[];
}

export function generateTimesheetReport(data: TimesheetReportData): void {
  const doc = new jsPDF(PDF_CONFIG.orientation, PDF_CONFIG.unit, PDF_CONFIG.format);

  // Header
  doc.setFontSize(18);
  doc.setTextColor(...PDF_CONFIG.colors.text);
  doc.text(data.title, PDF_CONFIG.margins.left, 20);

  doc.setFontSize(10);
  doc.setTextColor(...PDF_CONFIG.colors.textMuted);
  doc.text(data.dateRange, PDF_CONFIG.margins.left, 28);
  doc.text(
    `Generated: ${new Date().toLocaleDateString('en-US', { year: 'numeric', month: 'long', day: 'numeric' })}`,
    PDF_CONFIG.margins.left,
    34
  );

  // Total hours
  doc.setFontSize(12);
  doc.setTextColor(...PDF_CONFIG.colors.text);
  doc.text(`Total Hours: ${data.totalHours}`, PDF_CONFIG.margins.left, 45);

  // Table
  autoTable(doc, {
    startY: 52,
    head: [['Project', 'Hours', 'Entries', '% of Total']],
    body: data.rows.map(row => [
      row.projectName,
      row.totalHours,
      row.entryCount,
      row.percentage,
    ]),
    styles: { fontSize: 10, cellPadding: 3, textColor: PDF_CONFIG.colors.text },
    headStyles: { fillColor: PDF_CONFIG.colors.primary, textColor: [255, 255, 255], fontStyle: 'bold' },
    alternateRowStyles: { fillColor: PDF_CONFIG.colors.alternateRow },
    margin: { left: PDF_CONFIG.margins.left, right: PDF_CONFIG.margins.right },
    didDrawPage: (data) => {
      const pageCount = doc.getNumberOfPages();
      doc.setFontSize(8);
      doc.setTextColor(...PDF_CONFIG.colors.textMuted);
      doc.text(
        `Page ${data.pageNumber} of ${pageCount}`,
        doc.internal.pageSize.getWidth() / 2,
        doc.internal.pageSize.getHeight() - 10,
        { align: 'center' }
      );
    },
  });

  const filename = `timesheet-report-${new Date().toISOString().split('T')[0]}.pdf`;
  doc.save(filename);
}
```

8. Create `apps/web/src/components/reports/pdf/PdfExportButton.tsx`:

```typescript
'use client';

/**
 * PdfExportButton
 *
 * Button component that triggers PDF generation with loading state.
 */

import { useState } from 'react';
import { Download, Loader2 } from 'lucide-react';

interface PdfExportButtonProps {
  onExport: () => void;
  label?: string;
  disabled?: boolean;
}

export function PdfExportButton({ onExport, label = 'Export PDF', disabled = false }: PdfExportButtonProps) {
  const [isExporting, setIsExporting] = useState(false);

  const handleExport = async () => {
    setIsExporting(true);
    // Use requestAnimationFrame to prevent UI blocking
    requestAnimationFrame(() => {
      try {
        onExport();
      } finally {
        setIsExporting(false);
      }
    });
  };

  return (
    <button
      onClick={handleExport}
      disabled={disabled || isExporting}
      className="flex items-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors"
    >
      {isExporting ? (
        <Loader2 size={18} className="animate-spin" />
      ) : (
        <Download size={18} />
      )}
      {isExporting ? 'Generating...' : label}
    </button>
  );
}
```

9. Create `apps/web/src/components/reports/pdf/index.ts`:

```typescript
export { PdfExportButton } from './PdfExportButton';
export { PDF_CONFIG } from './pdfConfig';
export { generateAttendanceReport } from './generators/attendanceReport';
export { generateTimesheetReport } from './generators/timesheetReport';
```

10. Create `apps/web/src/components/reports/index.ts`:

```typescript
// Charts
export { AttendanceBarChart, TimesheetPieChart } from './charts';

// Widgets
export { MetricCard, NeedsAttentionSection, TeamStatusTable } from './widgets';

// PDF
export { PdfExportButton, generateAttendanceReport, generateTimesheetReport } from './pdf';
```

All components use:
- 'use client' directive where needed
- Consistent styling with existing Tailwind classes
- Motion animations matching existing patterns
- Loading states for async operations
  </action>
  <verify>
All files exist:
- `ls apps/web/src/components/reports/charts/` shows 3 files
- `ls apps/web/src/components/reports/widgets/` shows 4 files
- `ls apps/web/src/components/reports/pdf/` shows 3 files + generators/
  </verify>
  <done>Widget components (MetricCard, NeedsAttentionSection, TeamStatusTable) and PDF utilities (generators, config, export button) created</done>
</task>

</tasks>

<verification>
1. Dependencies installed: `npm list recharts jspdf jspdf-autotable --workspace=@satcom/web`
2. All component files exist with correct exports
3. TypeScript compiles: `npm run build --workspace=@satcom/web` (may show warnings but no errors)
4. Components are client-side only (all have 'use client' directive)
</verification>

<success_criteria>
- Recharts and jsPDF packages installed in web workspace
- Chart components render without hydration errors
- PDF export generates downloadable A4 portrait files
- All components export correctly from index files
</success_criteria>

<output>
After completion, create `.planning/phases/07-reports-dashboards/07-02-SUMMARY.md`
</output>
