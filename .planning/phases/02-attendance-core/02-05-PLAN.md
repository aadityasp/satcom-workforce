---
phase: 02-attendance-core
plan: 05
type: execute
wave: 3
depends_on: ["02-03", "02-04"]
files_modified:
  - apps/web/src/app/dashboard/page.tsx
  - apps/web/src/components/attendance/index.ts
autonomous: true

must_haves:
  truths:
    - "Dashboard shows AttendanceStatusCard for all users"
    - "Dashboard integrates with attendance components"
    - "Status card updates live without page refresh"
  artifacts:
    - path: "apps/web/src/app/dashboard/page.tsx"
      provides: "Integrated dashboard with new attendance components"
      contains: "AttendanceStatusCard"
    - path: "apps/web/src/components/attendance/index.ts"
      provides: "Barrel export for all attendance components"
      exports: ["AttendanceStatusCard", "CheckInModal", "CheckOutModal", "TimelineBar"]
  key_links:
    - from: "dashboard/page.tsx"
      to: "components/attendance"
      via: "import"
      pattern: "from.*components/attendance"
---

<objective>
Integrate the new attendance components into the dashboard, replacing the existing inline implementation.

Purpose: The dashboard currently has inline attendance logic. Replace with the new modular AttendanceStatusCard component for cleaner code and consistent UX.

Output: Dashboard uses AttendanceStatusCard for all non-admin users with full status card UX.
</objective>

<execution_context>
@/Users/adityaw/.claude/get-shit-done/workflows/execute-plan.md
@/Users/adityaw/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/phases/02-attendance-core/02-CONTEXT.md
@apps/web/src/app/dashboard/page.tsx
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create barrel export for attendance components</name>
  <files>apps/web/src/components/attendance/index.ts</files>
  <action>
Create `apps/web/src/components/attendance/index.ts`:

```typescript
export { AttendanceStatusCard } from './AttendanceStatusCard';
export { CheckInModal } from './CheckInModal';
export { CheckOutModal } from './CheckOutModal';
export { BreakButton } from './BreakButton';
export { BreakPolicyIndicator } from './BreakPolicyIndicator';
export { TimelineBar } from './TimelineBar';
export { TimelineEventList } from './TimelineEventList';
```

Also export types that might be needed externally.
  </action>
  <verify>
Run `npm run build --workspace=apps/web` - verify exports resolve correctly.
  </verify>
  <done>
All attendance components exportable from single import path.
  </done>
</task>

<task type="auto">
  <name>Task 2: Integrate AttendanceStatusCard into dashboard</name>
  <files>apps/web/src/app/dashboard/page.tsx</files>
  <action>
Update dashboard to use the new AttendanceStatusCard:

1. Import AttendanceStatusCard from '@/components/attendance'
2. Remove the inline attendance state (attendance, fetchTodayAttendance, handleCheckIn, etc.)
3. Remove the inline attendance card JSX in the "Employee Dashboard" section
4. Replace with: `<AttendanceStatusCard />`
5. The AttendanceStatusCard uses useAttendance internally, no props needed

Keep the existing admin dashboard logic unchanged - it doesn't use the detailed attendance card.

For employee view:
```tsx
{/* Employee Dashboard */}
{!isAdmin && (
  <>
    {/* Attendance Card */}
    <motion.div variants={itemVariants}>
      <AttendanceStatusCard />
    </motion.div>

    {/* Quick Actions - keep existing */}
    <motion.div variants={itemVariants} className="grid grid-cols-2 md:grid-cols-4 gap-4">
      {/* ... existing quick action buttons ... */}
    </motion.div>
  </>
)}
```

Also add an "Attendance" quick action card that links to /attendance page.
  </action>
  <verify>
1. Run `npm run build --workspace=apps/web`
2. Run dev server and visit /dashboard as Employee role
3. Verify AttendanceStatusCard renders correctly
4. Test check-in/out/break flow
  </verify>
  <done>
Dashboard uses AttendanceStatusCard. Old inline code removed. Quick action links to /attendance.
  </done>
</task>

<task type="auto">
  <name>Task 3: Add attendance link to navigation/quick actions</name>
  <files>apps/web/src/app/dashboard/page.tsx</files>
  <action>
In the quick actions grid for employees, ensure there's a card for "Attendance" that links to /attendance:

```tsx
<button
  onClick={() => router.push('/attendance')}
  className="bg-white rounded-xl p-4 border border-silver-200 hover:border-blue-300 hover:shadow-md transition-all text-left group"
>
  <div className="w-10 h-10 bg-blue-100 rounded-lg flex items-center justify-center mb-3 group-hover:bg-blue-200 transition-colors">
    <Clock size={20} className="text-blue-600" />
  </div>
  <p className="font-medium text-navy-900">Attendance</p>
  <p className="text-sm text-silver-500">View timeline</p>
</button>
```

If the quick actions grid already has Timesheets, Leave, Team, Messages - add Attendance before or replace one if there are too many.
  </action>
  <verify>
1. Visit /dashboard as Employee
2. See Attendance quick action
3. Click navigates to /attendance
  </verify>
  <done>
Attendance quick action visible and functional on dashboard.
  </done>
</task>

</tasks>

<verification>
1. Build passes: `npm run build --workspace=apps/web`
2. Dashboard renders for Employee without errors
3. AttendanceStatusCard shows correct state
4. Check-in modal opens from card
5. Break button works
6. Check-out modal shows summary
7. Attendance quick action links to /attendance
</verification>

<success_criteria>
- Dashboard uses modular AttendanceStatusCard
- Old inline attendance code removed
- Live timer works on dashboard
- Navigation to /attendance page works
- No regression in admin dashboard functionality
</success_criteria>

<output>
After completion, create `.planning/phases/02-attendance-core/02-05-SUMMARY.md`
</output>
